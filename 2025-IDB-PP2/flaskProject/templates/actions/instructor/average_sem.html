{% extends "layout.html" %}

{% block title %}Average Grade of a Class by Semester Range{% endblock %}

{% block content %}
<h2>Average Grade of a Class Across Semesters</h2>

{% if msg %}
    <div class="msg">{{ msg }}</div>
{% endif %}

<form method="POST" class="mb-4">
    <div class="row">
        <!-- Course selection -->
        <div class="col-md-4 mb-3">
            <label class="form-label">Course</label>
            <select name="course_id" class="form-select" required>
                <option value="">-- Select a Course --</option>
                {% for c in courses %}
                    <option value="{{ c[0] }}">{{ c[0] }} â€” {{ c[1] }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Start semester/year -->
        <div class="col-md-4 mb-3">
            <label class="form-label">Start Semester</label>
            <select name="start_semester" class="form-select" required>
                <option value="">-- Semester --</option>
                <option value="Spring">Spring</option>
                <option value="Summer">Summer</option>
                <option value="Fall">Fall</option>
                <option value="Winter">Winter</option>
            </select>

            <label class="form-label mt-2">Start Year</label>
            <input type="number" name="start_year" class="form-control" min="2000" max="2099" required>
        </div>

        <!-- End semester/year -->
        <div class="col-md-4 mb-3">
            <label class="form-label">End Semester</label>
            <select name="end_semester" class="form-select" required>
                <option value="">-- Semester --</option>
                <option value="Spring">Spring</option>
                <option value="Summer">Summer</option>
                <option value="Fall">Fall</option>
                <option value="Winter">Winter</option>
            </select>

            <label class="form-label mt-2">End Year</label>
            <input type="number" name="end_year" class="form-control" min="2000" max="2099" required>
        </div>
    </div>

    <button class="btn btn-primary mt-2">Compute Average</button>
</form>

{% if results %}
    <h4>Result</h4>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Course ID</th>
                <th>Title</th>
                <th>Average GPA</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ results[0] }}</td>  {# course_id #}
                <td>{{ results[1] }}</td>  {# title #}
                <td>
                    {% if results[2] != None %}
                        {{ "%.2f"|format(results[2]) }}
                    {% else %}
                        No graded enrollments
                    {% endif %}
                </td>
            </tr>
        </tbody>
    </table>
{% else %}
    <p>No data available.</p>
{% endif %}

{% endblock %}